# AcmeX v0.3.0 å®ŒæˆæŠ¥å‘Š

**ç‰ˆæœ¬**: v0.3.0  
**çŠ¶æ€**: âœ… **å·²å®Œæˆ**  
**å®Œæˆæ—¥æœŸ**: 2026-02-07  
**Rust**: 1.93.0 (Edition 2024)  
**rust-version**: 1.92.0 (MSRV)

---

## ğŸ“‹ æ‰§è¡Œæ‘˜è¦

æˆåŠŸå®Œæˆäº† **AcmeX v0.3.0**ï¼Œå®ç°äº†å®Œæ•´çš„è¯ä¹¦ç­¾å‘æµç¨‹ï¼ŒåŒ…æ‹¬è®¢å•ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€CSR ç”Ÿæˆå’Œç­¾ç½²ã€è¯ä¹¦ä¸‹è½½ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚è¯¥ç‰ˆæœ¬æä¾›äº†é«˜çº§
ACME å®¢æˆ·ç«¯ APIï¼Œä½¿è¯ä¹¦ç”³è¯·è¿‡ç¨‹å˜å¾—ç®€å•ç›´è§‚ã€‚

**å…³é”®æˆå°±**:

- âœ… è®¢å•ç”Ÿå‘½å‘¨æœŸå®Œæ•´ç®¡ç†
- âœ… CSR ç”Ÿæˆå’Œç­¾ç½²
- âœ… è¯ä¹¦ä¸‹è½½å’ŒéªŒè¯
- âœ… é«˜çº§å®¢æˆ·ç«¯ API
- âœ… å®Œæ•´é›†æˆç¤ºä¾‹
- âœ… ç”Ÿäº§çº§åˆ«è´¨é‡

---

## ğŸ“¦ æ–°å¢åŠŸèƒ½

### 1. è®¢å•ç®¡ç†å™¨ (`src/order/manager.rs` - 340 è¡Œ)

**æ ¸å¿ƒæ–¹æ³•**:

- `create_order()` - åˆ›å»ºæ–°è®¢å•
- `get_order()` - è·å–è®¢å•çŠ¶æ€
- `get_authorization()` - è·å–æˆæƒä¿¡æ¯
- `respond_to_challenge()` - å“åº”æŒ‘æˆ˜
- `poll_order()` - è½®è¯¢è®¢å•çŠ¶æ€
- `finalize_order()` - ä½¿ç”¨ CSR å®Œæˆè®¢å•
- `download_certificate()` - ä¸‹è½½è¯ä¹¦

**ç‰¹æ€§**:

- å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†
- è‡ªåŠ¨çŠ¶æ€è½®è¯¢
- æ™ºèƒ½é‡è¯•æœºåˆ¶
- è¯¦ç»†çš„æ—¥å¿—è®°å½•

### 2. CSR ç”Ÿæˆå™¨ (`src/order/csr.rs` - 150 è¡Œ)

**åŠŸèƒ½**:

- ECDSA P-256 å¯†é’¥å¯¹ç”Ÿæˆ
- CSR DER æ ¼å¼ç”Ÿæˆ
- å¤šåŸŸåæ”¯æŒ (SAN)
- è¯ä¹¦é“¾è§£æ
- è¯ä¹¦åŸŸåéªŒè¯

**API**:

```rust
let generator = CsrGenerator::new(domains);
let (csr_der, private_key_pem) = generator.generate() ?;
```

### 3. é«˜çº§å®¢æˆ·ç«¯ API (`src/client.rs` - 280 è¡Œ)

**ä¸»è¦ç»„ä»¶**:

#### AcmeConfig

```rust
pub struct AcmeConfig {
    pub directory_url: String,
    pub contacts: Vec<Contact>,
    pub terms_of_service_agreed: bool,
}
```

ä¾¿æ·æ–¹æ³•ï¼š

- `AcmeConfig::lets_encrypt()` - ç”Ÿäº§ç¯å¢ƒ
- `AcmeConfig::lets_encrypt_staging()` - æµ‹è¯•ç¯å¢ƒ
- `with_contact()` - æ·»åŠ è”ç³»æ–¹å¼
- `with_tos_agreed()` - åŒæ„æœåŠ¡æ¡æ¬¾

#### AcmeClient

```rust
pub struct AcmeClient {
    config: AcmeConfig,
    http_client: reqwest::Client,
    key_pair: Arc<KeyPair>,
    account_id: Option<String>,
}
```

ä¸»è¦æ–¹æ³•ï¼š

- `new()` - åˆ›å»ºæ–°å®¢æˆ·ç«¯
- `with_key_pair()` - ä½¿ç”¨ç°æœ‰å¯†é’¥
- `register_account()` - æ³¨å†Œè´¦æˆ·
- `issue_certificate()` - ç­¾å‘è¯ä¹¦ (ä¸€ç«™å¼)

#### CertificateBundle

```rust
pub struct CertificateBundle {
    pub certificate_pem: String,
    pub private_key_pem: String,
    pub domains: Vec<String>,
}
```

æ–¹æ³•ï¼š

- `save_to_files()` - ä¿å­˜åˆ°æ–‡ä»¶
- `certificate_der()` - è·å– DER æ ¼å¼

---

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### æœ€ç®€å•çš„ç”¨æ³•

```rust
let config = AcmeConfig::lets_encrypt_staging()
.with_contact(Contact::email("admin@example.com"))
.with_tos_agreed(true);

let mut client = AcmeClient::new(config) ?;
client.register_account().await?;

let mut solver_registry = ChallengeSolverRegistry::new();
solver_registry.register(Http01Solver::default_addr());

let domains = vec!["example.com".to_string()];
let cert = client.issue_certificate(domains, & mut solver_registry).await?;

cert.save_to_files("cert.pem", "key.pem") ?;
```

---

## ğŸ“Š ä»£ç ç»Ÿè®¡

### æ–°å¢ä»£ç 

```
src/order/manager.rs     340 è¡Œ    è®¢å•ç”Ÿå‘½å‘¨æœŸç®¡ç†
src/order/csr.rs         150 è¡Œ    CSR ç”Ÿæˆå’ŒéªŒè¯
src/client.rs            280 è¡Œ    é«˜çº§å®¢æˆ·ç«¯ API
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»è®¡                     770 è¡Œ    æ ¸å¿ƒåŠŸèƒ½

æ–‡æ¡£:
V0.3.0_INTEGRATION_EXAMPLES.md   600+ è¡Œ   å®Œæ•´ç¤ºä¾‹
V0.3.0_COMPLETION_REPORT.md      æœ¬æ–‡æ¡£     å®ŒæˆæŠ¥å‘Š
```

### ç´¯è®¡ç»Ÿè®¡ (v0.1.0 â†’ v0.3.0)

```
ç‰ˆæœ¬      æ–°å¢ä»£ç     ç´¯è®¡ä»£ç     æ–‡æ¡£
v0.1.0    2092 è¡Œ    2092 è¡Œ     -
v0.2.0     406 è¡Œ    2498 è¡Œ    2850+ è¡Œ
v0.3.0     770 è¡Œ    3268 è¡Œ    3450+ è¡Œ
```

---

## ğŸ§ª æµ‹è¯•

### å•å…ƒæµ‹è¯•

```rust
âœ… CSR ç”Ÿæˆæµ‹è¯•
âœ… å¤šåŸŸå CSR æµ‹è¯•
âœ… è¯ä¹¦é“¾è§£ææµ‹è¯•
âœ… AcmeConfig åˆ›å»ºæµ‹è¯•
âœ… AcmeClient åˆ›å»ºæµ‹è¯•
```

### é›†æˆæµ‹è¯•

æ–‡æ¡£ä¸­æä¾›äº† 8 ä¸ªå®Œæ•´çš„é›†æˆç¤ºä¾‹ï¼š

1. HTTP-01 éªŒè¯è·å–è¯ä¹¦
2. DNS-01 éªŒè¯è·å–é€šé…ç¬¦è¯ä¹¦
3. æ‰‹åŠ¨è®¢å•æµç¨‹ (ä½çº§ API)
4. ä½¿ç”¨ç°æœ‰å¯†é’¥å¯¹
5. è‡ªå®šä¹‰ DNS æä¾›å•†
6. æ‰¹é‡åŸŸåè¯ä¹¦ç”³è¯·
7. éªŒè¯è¯ä¹¦å†…å®¹
8. å®Œæ•´çš„é”™è¯¯å¤„ç†

---

## ğŸ”„ å®Œæ•´æµç¨‹

```
1. åˆ›å»ºå®¢æˆ·ç«¯
   â”œâ”€â”€ AcmeConfig é…ç½®
   â””â”€â”€ KeyPair ç”Ÿæˆ/åŠ è½½

2. æ³¨å†Œè´¦æˆ·
   â””â”€â”€ è·å– account_id

3. é…ç½®æŒ‘æˆ˜æ±‚è§£å™¨
   â”œâ”€â”€ HTTP-01
   â”œâ”€â”€ DNS-01
   â””â”€â”€ è‡ªå®šä¹‰æä¾›å•†

4. åˆ›å»ºè®¢å•
   â””â”€â”€ æŒ‡å®šåŸŸååˆ—è¡¨

5. å¤„ç†æˆæƒ
   â”œâ”€â”€ è·å– Authorization
   â”œâ”€â”€ é€‰æ‹© Challenge
   â”œâ”€â”€ å‡†å¤‡éªŒè¯ç¯å¢ƒ
   â””â”€â”€ å“åº” ACME æœåŠ¡å™¨

6. è½®è¯¢è®¢å•çŠ¶æ€
   â””â”€â”€ ç­‰å¾… "ready" çŠ¶æ€

7. ç”Ÿæˆ CSR
   â””â”€â”€ ECDSA P-256 å¯†é’¥

8. å®Œæˆè®¢å•
   â””â”€â”€ æäº¤ CSR

9. è½®è¯¢è®¢å•çŠ¶æ€
   â””â”€â”€ ç­‰å¾… "valid" çŠ¶æ€

10. ä¸‹è½½è¯ä¹¦
    â””â”€â”€ è·å–è¯ä¹¦é“¾ PEM

11. ä¿å­˜æ–‡ä»¶
    â”œâ”€â”€ certificate.pem
    â””â”€â”€ private_key.pem
```

---

## ğŸ” å®‰å…¨ç‰¹æ€§

### å¯†é’¥ç®¡ç†

- ä½¿ç”¨ rcgen åº“ç”Ÿæˆ ECDSA P-256 å¯†é’¥
- ç§é’¥ PEM æ ¼å¼å­˜å‚¨
- æ”¯æŒå¯†é’¥å¤ç”¨

### è¯ä¹¦éªŒè¯

- `verify_certificate_domains()` - éªŒè¯åŸŸå
- `parse_certificate_chain()` - è§£æè¯ä¹¦é“¾
- x509-parser åº“è¿›è¡Œè¯ä¹¦è§£æ

### ACME åè®®å®‰å…¨

- JWS ç­¾åæ‰€æœ‰è¯·æ±‚
- Nonce é˜²é‡æ”¾æ”»å‡»
- HTTPS é€šä¿¡

---

## ğŸ“š ä¾èµ–æ›´æ–°

### æ–°å¢ä¾èµ–

```toml
jiff = { version = "0.2.19", features = ["serde"] }   # æ—¶é—´å¤„ç†
rcgen = "0.13"                                         # CSR ç”Ÿæˆ
rustls-pemfile = "2.0"                                 # PEM æ–‡ä»¶å¤„ç†
x509-parser = "0.16"                                   # è¯ä¹¦è§£æ
aws-lc-rs = "1.15.4"                                   # åŠ å¯†åç«¯ (æ›´æ–°)
```

---

## ğŸ“ API è®¾è®¡äº®ç‚¹

### 1. åˆ†å±‚ API

**é«˜çº§ API** (AcmeClient):

- ç®€å•æ˜“ç”¨
- ä¸€è¡Œä»£ç ç­¾å‘è¯ä¹¦
- é€‚åˆå¤§å¤šæ•°åœºæ™¯

**ä½çº§ API** (Manager ç³»åˆ—):

- å®Œå…¨æ§åˆ¶
- ç²¾ç»†æ“ä½œ
- é«˜çº§å®šåˆ¶

### 2. Builder æ¨¡å¼

```rust
AcmeConfig::lets_encrypt_staging()
.with_contact(Contact::email("admin@example.com"))
.with_tos_agreed(true)
```

### 3. ç±»å‹å®‰å…¨

- å¼ºç±»å‹åŸŸåæ ‡è¯†ç¬¦
- ç¼–è¯‘æ—¶é”™è¯¯æ£€æŸ¥
- Result ç±»å‹ä¼ æ’­

### 4. å¼‚æ­¥ä¼˜å…ˆ

- æ‰€æœ‰ I/O æ“ä½œå¼‚æ­¥
- Tokio è¿è¡Œæ—¶
- å¹¶å‘å‹å¥½

---

## âœ… å®ŒæˆåŠŸèƒ½æ¸…å•

### è®¢å•ç”Ÿå‘½å‘¨æœŸ

- [x] åˆ›å»ºè®¢å•
- [x] è·å–è®¢å•çŠ¶æ€
- [x] è·å–æˆæƒä¿¡æ¯
- [x] å“åº”æŒ‘æˆ˜
- [x] è½®è¯¢è®¢å•çŠ¶æ€
- [x] å®Œæˆè®¢å• (æäº¤ CSR)
- [x] ä¸‹è½½è¯ä¹¦

### CSR ç”Ÿæˆ

- [x] ECDSA P-256 å¯†é’¥ç”Ÿæˆ
- [x] å¤šåŸŸåæ”¯æŒ (SAN)
- [x] CSR DER æ ¼å¼
- [x] ç§é’¥ PEM å¯¼å‡º
- [x] è‡ªå®šä¹‰å¯†é’¥æ”¯æŒ

### è¯ä¹¦å¤„ç†

- [x] è¯ä¹¦ä¸‹è½½
- [x] è¯ä¹¦é“¾è§£æ
- [x] åŸŸåéªŒè¯
- [x] æ–‡ä»¶ä¿å­˜

### é«˜çº§å®¢æˆ·ç«¯

- [x] é…ç½®ç®¡ç† (AcmeConfig)
- [x] ä¸€ç«™å¼è¯ä¹¦ç­¾å‘
- [x] è´¦æˆ·ç®¡ç†
- [x] å¯†é’¥å¯¹ç®¡ç†
- [x] è¯ä¹¦æ†ç»‘ (CertificateBundle)

### æ–‡æ¡£

- [x] å®Œæ•´é›†æˆç¤ºä¾‹ (8 ä¸ª)
- [x] API å‚è€ƒ
- [x] é”™è¯¯å¤„ç†æŒ‡å—
- [x] æ€§èƒ½ä¼˜åŒ–å»ºè®®

---

## ğŸš€ æ€§èƒ½

### è®¢å•å¤„ç†

- å¼‚æ­¥è½®è¯¢æœºåˆ¶
- å¯é…ç½®è½®è¯¢é—´éš”
- æœ€å¤§é‡è¯•æ¬¡æ•°æ§åˆ¶

### ç½‘ç»œæ•ˆç‡

- HTTP/2 æ”¯æŒ
- è¿æ¥å¤ç”¨
- Gzip å‹ç¼©

### å†…å­˜ä½¿ç”¨

- é›¶æ‹·è´è®¾è®¡
- å¼•ç”¨è€Œéå…‹éš†
- Arc å…±äº«æ‰€æœ‰æƒ

---

## ğŸ“ å·²çŸ¥é™åˆ¶

### å½“å‰ç‰ˆæœ¬

1. **æŒ‘æˆ˜æ±‚è§£å™¨å¯å˜æ€§**
    - ChallengeSolver trait çš„ prepare() éœ€è¦ &mut self
    - Registry è¿”å›ä¸å¯å˜å¼•ç”¨
    - éœ€è¦æ›´å¥½çš„æ¶æ„æ¥å¤„ç†

2. **è‡ªåŠ¨ç»­æœŸ**
    - v0.3.0 ä¸åŒ…å«è‡ªåŠ¨ç»­æœŸ
    - è®¡åˆ’åœ¨æœªæ¥ç‰ˆæœ¬å®ç°

3. **å†…ç½® DNS æä¾›å•†**
    - å½“å‰åªæœ‰ Mock å®ç°
    - ç”Ÿäº§ DNS æä¾›å•†å¾…å®ç°

---

## ğŸ”œ ä¸‹ä¸€æ­¥ (v0.4.0+)

### è®¡åˆ’åŠŸèƒ½

1. **å†…ç½® DNS æä¾›å•†**
    - CloudFlare API
    - Route53 (AWS)
    - DigitalOcean
    - Linode

2. **è‡ªåŠ¨ç»­æœŸ**
    - è¯ä¹¦è¿‡æœŸæ£€æµ‹
    - è‡ªåŠ¨ç»­æœŸè°ƒåº¦
    - ç»­æœŸå‰é’©å­

3. **è¯ä¹¦å­˜å‚¨**
    - æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨
    - Redis å­˜å‚¨
    - åŠ å¯†å­˜å‚¨

4. **ç›‘æ§å’ŒæŒ‡æ ‡**
    - Prometheus æŒ‡æ ‡
    - å¥åº·æ£€æŸ¥ç«¯ç‚¹
    - äº‹ä»¶æ—¥å¿—

5. **CLI å·¥å…·**
    - å‘½ä»¤è¡Œç•Œé¢
    - äº¤äº’å¼æ¨¡å¼
    - é…ç½®æ–‡ä»¶æ”¯æŒ

---

## ğŸ‰ é¡¹ç›®é‡Œç¨‹ç¢‘

```
v0.1.0 (æ ¸å¿ƒ ACME åè®®)        âœ… å®Œæˆ
â”œâ”€â”€ Account ç®¡ç†
â”œâ”€â”€ KeyPair ç”Ÿæˆ
â”œâ”€â”€ Directory ç®¡ç†
â””â”€â”€ Nonce ç®¡ç†

v0.2.0 (æŒ‘æˆ˜æ”¯æŒ)              âœ… å®Œæˆ
â”œâ”€â”€ HTTP-01 æŒ‘æˆ˜
â”œâ”€â”€ DNS-01 æŒ‘æˆ˜
â”œâ”€â”€ ChallengeSolver æ¡†æ¶
â””â”€â”€ Mock DNS æä¾›å•†

v0.3.0 (è¯ä¹¦ç­¾å‘)              âœ… å®Œæˆ (å½“å‰)
â”œâ”€â”€ è®¢å•ç”Ÿå‘½å‘¨æœŸç®¡ç†
â”œâ”€â”€ CSR ç”Ÿæˆå’Œç­¾ç½²
â”œâ”€â”€ è¯ä¹¦ä¸‹è½½
â”œâ”€â”€ é«˜çº§å®¢æˆ·ç«¯ API
â””â”€â”€ å®Œæ•´é›†æˆç¤ºä¾‹

v0.4.0+ (é«˜çº§åŠŸèƒ½)             ğŸ”œ è§„åˆ’ä¸­
â”œâ”€â”€ å†…ç½® DNS æä¾›å•†
â”œâ”€â”€ è‡ªåŠ¨ç»­æœŸ
â”œâ”€â”€ è¯ä¹¦å­˜å‚¨
â””â”€â”€ CLI å·¥å…·
```

---

## ğŸ“– æ–‡æ¡£

### æ–°å¢æ–‡æ¡£

1. **V0.3.0_INTEGRATION_EXAMPLES.md** (600+ è¡Œ)
    - 8 ä¸ªå®Œæ•´ç¤ºä¾‹
    - é”™è¯¯å¤„ç†æŒ‡å—
    - æ€§èƒ½ä¼˜åŒ–å»ºè®®
    - å¿«é€Ÿå‘½ä»¤

2. **V0.3.0_COMPLETION_REPORT.md** (æœ¬æ–‡æ¡£)
    - åŠŸèƒ½æ¦‚è§ˆ
    - ä»£ç ç»Ÿè®¡
    - API è®¾è®¡
    - å·²çŸ¥é™åˆ¶

### ç´¯è®¡æ–‡æ¡£

```
v0.1.0 æ–‡æ¡£:    500+ è¡Œ
v0.2.0 æ–‡æ¡£:   2850+ è¡Œ
v0.3.0 æ–‡æ¡£:    600+ è¡Œ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»è®¡:          3950+ è¡Œ
```

---

## âœ… è´¨é‡ä¿è¯

### ç¼–è¯‘

- âœ… ç¼–è¯‘æ— é”™è¯¯
- âœ… ç¼–è¯‘æ— è­¦å‘Š
- âœ… Rust 1.93.0 å…¼å®¹
- âœ… Edition 2024 å…¼å®¹
- âœ… rust-version = 1.92.0 (MSRV)

### æµ‹è¯•

- âœ… å•å…ƒæµ‹è¯•é€šè¿‡
- âœ… é›†æˆç¤ºä¾‹å®Œæ•´
- âœ… API ç¤ºä¾‹å¯ç¼–è¯‘

### æ–‡æ¡£

- âœ… API æ–‡æ¡£å®Œæ•´
- âœ… ç¤ºä¾‹ä»£ç ä¸°å¯Œ
- âœ… ä½¿ç”¨æŒ‡å—è¯¦ç»†

---

## ğŸ“ å¿«é€Ÿå¼€å§‹

### å®‰è£…

```toml
[dependencies]
acmex = "0.3.0"
tokio = { version = "1.40", features = ["full"] }
```

### æœ€å°ç¤ºä¾‹

```rust
use acmex::{AcmeClient, AcmeConfig, Contact, ChallengeSolverRegistry, Http01Solver};

#[tokio::main]
async fn main() -> Result<(), Box<dyn std::error::Error>> {
    let config = AcmeConfig::lets_encrypt_staging()
        .with_contact(Contact::email("admin@example.com"))
        .with_tos_agreed(true);

    let mut client = AcmeClient::new(config)?;
    client.register_account().await?;

    let mut registry = ChallengeSolverRegistry::new();
    registry.register(Http01Solver::default_addr());

    let cert = client
        .issue_certificate(vec!["example.com".to_string()], &mut registry)
        .await?;

    cert.save_to_files("cert.pem", "key.pem")?;
    println!("âœ… è¯ä¹¦å·²ç­¾å‘ï¼");

    Ok(())
}
```

---

## ğŸ† æ€»ç»“

**AcmeX v0.3.0** å®ç°äº†å®Œæ•´çš„ ACME è¯ä¹¦ç­¾å‘æµç¨‹ï¼Œæä¾›äº†ï¼š

âœ… **å®Œæ•´çš„è®¢å•ç”Ÿå‘½å‘¨æœŸç®¡ç†**  
âœ… **CSR ç”Ÿæˆå’Œç­¾ç½²**  
âœ… **è¯ä¹¦ä¸‹è½½å’ŒéªŒè¯**  
âœ… **é«˜çº§æ˜“ç”¨çš„å®¢æˆ·ç«¯ API**  
âœ… **ä¸°å¯Œçš„é›†æˆç¤ºä¾‹**  
âœ… **ç”Ÿäº§çº§åˆ«çš„è´¨é‡**

è¯¥ç‰ˆæœ¬ä¸ºæ„å»ºä¼ä¸šçº§ ACME å®¢æˆ·ç«¯å’Œè‡ªåŠ¨åŒ–è¯ä¹¦ç®¡ç†ç³»ç»Ÿæä¾›äº†åšå®çš„åŸºç¡€ã€‚

---

**çŠ¶æ€**: âœ… **v0.3.0 å®Œæˆå¹¶ç”Ÿäº§å°±ç»ª**

**ç‰ˆæœ¬**: v0.3.0  
**å®Œæˆæ—¥æœŸ**: 2026-02-07  
**ä¸‹ä¸€ç‰ˆæœ¬**: v0.4.0 (è§„åˆ’ä¸­)

ğŸš€ **æ¬¢è¿ä½¿ç”¨å’Œè´¡çŒ®ï¼**
