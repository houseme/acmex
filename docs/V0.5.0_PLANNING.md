# AcmeX v0.5.0 - åŠŸèƒ½æ¨¡å—ç»†èŠ‚è®¾è®¡æ–‡æ¡£

**ç‰ˆæœ¬**: v0.5.0 (è®¡åˆ’ä¸­)  
**çŠ¶æ€**: ğŸ“‹ è®¾è®¡é˜¶æ®µ  
**ç›®æ ‡å®Œæˆæ—¶é—´**: 2026-Q2  
**é¢„è®¡å·¥ä½œé‡**: 60-80 å°æ—¶

---

## ğŸ“‹ æ‰§è¡Œæ‘˜è¦

AcmeX v0.5.0 è‡´åŠ›äºå®Œå–„ç”¨æˆ·äº¤äº’ä½“éªŒå’Œæ‰©å±•ç”Ÿæ€æ”¯æŒï¼Œé€šè¿‡å®Œæ•´çš„ CLI å®ç°ã€é…ç½®ç®¡ç†ã€é¢å¤–çš„ DNS æä¾›å•†é›†æˆä»¥åŠå¯è§†åŒ–ç®¡ç†ç•Œé¢ï¼Œä½¿
AcmeX æˆä¸ºä¼ä¸šçº§è¯ä¹¦ç®¡ç†çš„å®Œæ•´è§£å†³æ–¹æ¡ˆã€‚

### æ ¸å¿ƒç›®æ ‡

- âœ… å®Œæ•´ CLI å·¥å…·å®ç° (obtain, renew, daemon, info å‘½ä»¤)
- âœ… TOML é…ç½®æ–‡ä»¶æ”¯æŒ
- âœ… 4 ä¸ªæ–°å¢ DNS æä¾›å•† (Azure, Google Cloud, Alibaba Cloud, Godaddy)
- âœ… Web UI ç®¡ç†ç•Œé¢åŸºç¡€æ¡†æ¶
- âœ… Webhook é€šçŸ¥ç³»ç»Ÿ

### é¢„æœŸæˆæœ

- ç”Ÿäº§çº§ CLI å·¥å…·
- é›¶é…ç½®å¯åŠ¨æ”¯æŒ
- å®Œæ•´çš„æä¾›å•†è¦†ç›–
- å¯è§†åŒ–ç®¡ç†ç•Œé¢

---

## ğŸ¯ Module 1: å®Œæ•´ CLI å®ç°

### ç›®æ ‡

å®Œæˆæ‰€æœ‰ CLI å‘½ä»¤çš„ç”Ÿäº§çº§å®ç°ï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿå®Œå…¨é€šè¿‡å‘½ä»¤è¡Œç®¡ç†è¯ä¹¦ã€‚

### 1.1 Obtain å‘½ä»¤å®Œæ•´å®ç° âœ…

**æ–‡ä»¶**: `src/cli/commands/obtain.rs`  
**é¢„è®¡ä»£ç è¡Œæ•°**: 250-300 è¡Œ (å·²å®ç°æ ¸å¿ƒæµç¨‹)

#### åŠŸèƒ½éœ€æ±‚

```rust
// å®Œæ•´çš„ obtain å‘½ä»¤å®ç°
pub async fn handle_obtain_complete(args: ObtainArgs) -> Result<()> {
    // 1. åˆå§‹åŒ– ACME å®¢æˆ·ç«¯
    // 2. æ³¨å†Œè´¦æˆ· (å¦‚æœéœ€è¦)
    // 3. åˆ›å»ºè®¢å•
    // 4. é…ç½®æŒ‘æˆ˜æ±‚è§£å™¨ (HTTP-01 æˆ– DNS-01)
    // 5. å®ŒæˆæŒ‘æˆ˜
    // 6. ç”³è¯·è¯ä¹¦
    // 7. ä¿å­˜åˆ°æŒ‡å®šä½ç½®
    // 8. æ˜¾ç¤ºæˆåŠŸä¿¡æ¯
}
```

#### å‚æ•°æ‰©å±•

- `--domains <DOMAINS>...` - åŸŸååˆ—è¡¨
- `--email <EMAIL>` - è”ç³»é‚®ç®±
- `--challenge <TYPE>` - éªŒè¯æ–¹å¼ (http-01/dns-01/tls-alpn-01)
- `--dns-provider <PROVIDER>` - DNS æä¾›å•† (cloudflare/digitalocean/linode/azure/gcloud)
- `--cert-path <PATH>` - è¯ä¹¦è¾“å‡ºè·¯å¾„
- `--key-path <PATH>` - å¯†é’¥è¾“å‡ºè·¯å¾„
- `--chain-path <PATH>` - è¯ä¹¦é“¾è¾“å‡ºè·¯å¾„ (å¯é€‰)
- `--prod` - ä½¿ç”¨ç”Ÿäº§ç¯å¢ƒ Let's Encrypt
- `--staging` - ä½¿ç”¨æµ‹è¯•ç¯å¢ƒ
- `--config <PATH>` - é…ç½®æ–‡ä»¶è·¯å¾„

#### æ ¸å¿ƒåŠŸèƒ½

1. æ™ºèƒ½å®¢æˆ·ç«¯åˆå§‹åŒ– (æ”¯æŒé…ç½®æ–‡ä»¶)
2. è´¦æˆ·æ³¨å†Œæˆ–åŠ è½½
3. è®¢å•åˆ›å»ºå’Œç®¡ç†
4. æŒ‘æˆ˜æ±‚è§£ (æ”¯æŒå¤šç§æ–¹å¼)
5. è¯ä¹¦ä¸‹è½½å’ŒéªŒè¯
6. å½©è‰²è¾“å‡ºå’Œè¿›åº¦æ˜¾ç¤º

#### é”™è¯¯å¤„ç†

- DNS è§£æå¤±è´¥
- æŒ‘æˆ˜éªŒè¯å¤±è´¥
- æœåŠ¡å™¨é”™è¯¯
- æ–‡ä»¶å†™å…¥å¤±è´¥
- è¶…æ—¶å¤„ç†

### 1.2 Renew å‘½ä»¤å®Œæ•´å®ç° âœ…

**æ–‡ä»¶**: `src/cli/commands/renew.rs`  
**é¢„è®¡ä»£ç è¡Œæ•°**: 200-250 è¡Œ (å·²å®ç°æ ¸å¿ƒé€»è¾‘)

#### åŠŸèƒ½éœ€æ±‚

```rust
pub async fn handle_renew_complete(args: RenewArgs) -> Result<()> {
    // 1. åŠ è½½å­˜å‚¨çš„è¯ä¹¦
    // 2. æ£€æŸ¥è¿‡æœŸæ—¶é—´
    // 3. åˆ¤æ–­æ˜¯å¦éœ€è¦ç»­æœŸ
    // 4. ç”³è¯·æ–°è¯ä¹¦
    // 5. éªŒè¯æ–°è¯ä¹¦
    // 6. å¤‡ä»½æ—§è¯ä¹¦
    // 7. æ›¿æ¢ä¸ºæ–°è¯ä¹¦
    // 8. æ˜¾ç¤ºç»­æœŸç»“æœ
}
```

#### å‚æ•°æ‰©å±•

- `--domains <DOMAINS>...` - åŸŸååˆ—è¡¨
- `--cert-path <PATH>` - å½“å‰è¯ä¹¦è·¯å¾„
- `--key-path <PATH>` - å½“å‰å¯†é’¥è·¯å¾„
- `--force` - å¼ºåˆ¶ç»­æœŸ
- `--backup-dir <PATH>` - å¤‡ä»½ç›®å½•
- `--check-only` - ä»…æ£€æŸ¥ï¼Œä¸ç»­æœŸ
- `--renew-before <DAYS>` - æå‰å¤šå°‘å¤©ç»­æœŸ (é»˜è®¤ 30)

#### æ ¸å¿ƒåŠŸèƒ½

1. è¯ä¹¦è§£æå’Œè¿‡æœŸæ£€æŸ¥
2. è¿‡æœŸæ—¶é—´çª—å£åˆ¤æ–­
3. å¢é‡ç»­æœŸ (ä¿æŒç°æœ‰é…ç½®)
4. è¯ä¹¦å¤‡ä»½
5. åŸå­æ€§æ›¿æ¢
6. é”™è¯¯å›æ»š

#### ç‰¹æ®Šå¤„ç†

- SAN æ£€æŸ¥å’Œæ¯”å¯¹
- å¯†é’¥é‡ç”¨ vs æ–°ç”Ÿæˆ
- ç»­æœŸå‰åé€šçŸ¥
- ç»­æœŸå¤±è´¥æ¢å¤

### 1.3 Daemon å‘½ä»¤å®Œæ•´å®ç° âœ…

**æ–‡ä»¶**: `src/cli/commands/daemon.rs`  
**é¢„è®¡ä»£ç è¡Œæ•°**: 300-350 è¡Œ (å·²å®ç°è°ƒåº¦æ¡†æ¶)

#### åŠŸèƒ½éœ€æ±‚

```rust
pub async fn handle_daemon_complete(args: DaemonArgs) -> Result<()> {
    // 1. åŠ è½½é…ç½®æ–‡ä»¶
    // 2. åˆå§‹åŒ–ç»­æœŸè°ƒåº¦å™¨
    // 3. æ³¨å†Œé’©å­ (é€šçŸ¥ã€éƒ¨ç½²ç­‰)
    // 4. å¯åŠ¨åå°è½®è¯¢
    // 5. å¤„ç†ä¿¡å· (SIGTERM, SIGINT)
    // 6. ä¼˜é›…å…³é—­
}
```

#### å‚æ•°æ‰©å±•

- `--domains <DOMAINS>...` - ç®¡ç†çš„åŸŸååˆ—è¡¨
- `--config <PATH>` - TOML é…ç½®æ–‡ä»¶
- `--check-interval <SECS>` - æ£€æŸ¥é—´éš” (é»˜è®¤ 3600)
- `--renew-before <DAYS>` - ç»­æœŸçª—å£ (é»˜è®¤ 30)
- `--log-file <PATH>` - æ—¥å¿—æ–‡ä»¶
- `--pid-file <PATH>` - PID æ–‡ä»¶ (ä¾¿äºç®¡ç†)
- `--notify-email <EMAIL>` - é€šçŸ¥é‚®ç®±
- `--webhook <URL>` - Webhook URL
- `--foreground` - å‰å°è¿è¡Œ (è°ƒè¯•ç”¨)

#### æ ¸å¿ƒåŠŸèƒ½

1. åå°è¿è¡Œç®¡ç†
2. å®šæœŸç»­æœŸæ£€æŸ¥
3. å¤šè¯ä¹¦ç®¡ç†
4. é’©å­ç³»ç»Ÿ (ç»­æœŸå‰/å)
5. é”™è¯¯æ¢å¤
6. ä¼˜é›…å…³é—­

#### é«˜çº§ç‰¹æ€§

- å¹¶å‘ç»­æœŸç®¡ç†
- åˆ†å¸ƒå¼åŒæ­¥ (etcd/Redis)
- æŒ‡æ ‡å¯¼å‡º
- å¥åº·æ£€æŸ¥ç«¯ç‚¹
- æ—¥å¿—è½®è½¬

### 1.4 Info å‘½ä»¤å®Œæ•´å®ç° âœ…

**æ–‡ä»¶**: `src/cli/commands/info.rs`  
**é¢„è®¡ä»£ç è¡Œæ•°**: 150-200 è¡Œ (å·²å®ç°)

#### åŠŸèƒ½éœ€æ±‚

```rust
pub async fn handle_info_complete(args: InfoArgs) -> Result<()> {
    // 1. è¯»å–è¯ä¹¦æ–‡ä»¶
    // 2. è§£æ X.509 ç»“æ„
    // 3. æå–å…³é”®ä¿¡æ¯
    // 4. æ ¼å¼åŒ–è¾“å‡º
    // 5. å¯é€‰è¾“å‡º JSON
}
```

#### å‚æ•°æ‰©å±•

- `--cert <PATH>` - è¯ä¹¦æ–‡ä»¶è·¯å¾„
- `--key <PATH>` - å¯é€‰æ£€æŸ¥å¯†é’¥åŒ¹é…
- `--format <FORMAT>` - è¾“å‡ºæ ¼å¼ (text/json/table)
- `--detail` - è¯¦ç»†è¾“å‡º
- `--check-expiry` - æ£€æŸ¥è¿‡æœŸæ—¶é—´
- `--verify-chain` - éªŒè¯è¯ä¹¦é“¾

#### è¾“å‡ºå†…å®¹

```
âœ… è¯ä¹¦ä¿¡æ¯
â”œâ”€â”€ Subject: CN=example.com
â”œâ”€â”€ Issuer: C=US, O=Let's Encrypt
â”œâ”€â”€ Serial: ABC123...
â”œâ”€â”€ Valid From: 2024-01-01
â”œâ”€â”€ Valid Until: 2025-01-01 (å‰©ä½™ 298 å¤©) â°
â”œâ”€â”€ SAN: example.com, www.example.com, api.example.com
â”œâ”€â”€ Key Type: EC P-256 (ECDSA)
â”œâ”€â”€ Signature Algorithm: SHA256WithRSA
â””â”€â”€ Public Key Size: 256 bits
```

---

## ğŸ¯ Module 2: TOML é…ç½®æ–‡ä»¶æ”¯æŒ âœ…

### ç›®æ ‡

æ”¯æŒ TOML æ ¼å¼çš„é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨æˆ·å¯ä»¥ç®¡ç†å¤æ‚çš„é…ç½®è€Œæ— éœ€é•¿å‘½ä»¤è¡Œã€‚

### 2.1 é…ç½®ç»“æ„è®¾è®¡ âœ…

**æ–‡ä»¶**: `src/config.rs`  
**é¢„è®¡ä»£ç è¡Œæ•°**: 300-400 è¡Œ

#### é…ç½®æ–‡ä»¶ç¤ºä¾‹

```toml
# acmex.toml - AcmeX é…ç½®æ–‡ä»¶

[acme]
# ACME æœåŠ¡å™¨ URL
directory = "https://acme-v02.api.letsencrypt.org/directory"
# æˆ–ä½¿ç”¨é¢„è®¾ï¼š"letsencrypt" / "letsencrypt-staging" / "zerossl"
preset = "letsencrypt"

# è´¦æˆ·è”ç³»ä¿¡æ¯
contact = ["mailto:admin@example.com"]

# TOS åŒæ„
tos_agreed = true

[storage]
# å­˜å‚¨åç«¯ï¼š"file", "redis", "encrypted"
backend = "encrypted"

# æ–‡ä»¶å­˜å‚¨é…ç½®
[storage.file]
path = ".acmex/certs"

# Redis å­˜å‚¨é…ç½®
[storage.redis]
url = "redis://127.0.0.1:6379/0"
connection_pool_size = 10

# åŠ å¯†å­˜å‚¨é…ç½®
[storage.encrypted]
inner_backend = "file"
encryption_key = "${ACMEX_ENCRYPTION_KEY}"  # ä»ç¯å¢ƒå˜é‡è¯»å–
key_format = "hex"  # "hex" æˆ– "base64"

[challenge]
# é»˜è®¤æŒ‘æˆ˜æ–¹å¼
type = "dns-01"

# HTTP-01 é…ç½®
[challenge.http01]
listen_addr = "0.0.0.0:80"
domain = "example.com"

# DNS-01 é…ç½®
[challenge.dns01]
provider = "cloudflare"
api_token = "${CF_API_TOKEN}"
zone_id = "${CF_ZONE_ID}"

# å¤šæä¾›å•†é…ç½®
[[challenge.dns01.providers]]
name = "cloudflare"
api_token = "${CF_API_TOKEN}"
zone_id = "${CF_ZONE_ID}"

[[challenge.dns01.providers]]
name = "digitalocean"
api_token = "${DO_API_TOKEN}"
domain = "example.com"

[renewal]
# ç»­æœŸæ£€æŸ¥é—´éš” (ç§’)
check_interval = 3600

# æå‰å¤šå°‘å¤©å¼€å§‹ç»­æœŸ
renew_before_days = 30

# å¤±è´¥é‡è¯•
max_retries = 3
retry_delay_secs = 300

[renewal.hooks]
# ç»­æœŸå‰é’©å­
before = "hooks/before_renewal.sh"
# ç»­æœŸåé’©å­
after = "hooks/after_renewal.sh"
# é”™è¯¯é’©å­
on_error = "hooks/on_error.sh"

[metrics]
# å¯ç”¨ Prometheus æŒ‡æ ‡
enabled = true

# æŒ‡æ ‡å¯¼å‡ºåœ°å€
listen_addr = "127.0.0.1:9090"

# æŒ‡æ ‡å‰ç¼€
prefix = "acmex"

[notifications]
# Webhook é€šçŸ¥
[[notifications.webhooks]]
url = "https://hooks.slack.com/services/..."
events = ["renewal_success", "renewal_failed"]
format = "json"

# é‚®ä»¶é€šçŸ¥
[[notifications.email]]
smtp_host = "smtp.gmail.com"
smtp_port = 587
from = "acmex@example.com"
to = ["admin@example.com"]
events = ["renewal_failed"]

[cli]
# CLI è¾“å‡ºæ ¼å¼
output_format = "text"  # "text", "json", "csv"

# é¢œè‰²è¾“å‡º
colors = true

# æ—¥å¿—çº§åˆ«
log_level = "info"

# æ—¥å¿—æ–‡ä»¶
log_file = "logs/acmex.log"

# æ—¥å¿—å¤§å°é™åˆ¶ (MB)
log_max_size = 100

# æ—¥å¿—å¤‡ä»½æ•°
log_backup_count = 10
```

### 2.2 é…ç½®è§£æå®ç° âœ…

```rust
#[derive(Debug, Deserialize)]
pub struct AcmeConfig {
    pub acme: AcmeSettings,
    pub storage: StorageSettings,
    pub challenge: ChallengeSettings,
    pub renewal: RenewalSettings,
    #[serde(default)]
    pub metrics: Option<MetricsSettings>,
    #[serde(default)]
    pub notifications: Option<NotificationSettings>,
    #[serde(default)]
    pub cli: Option<CliSettings>,
}

impl AcmeConfig {
    /// ä»æ–‡ä»¶åŠ è½½é…ç½®
    pub fn from_file(path: &str) -> Result<Self> { ... }

    /// ä»å­—ç¬¦ä¸²åŠ è½½é…ç½®
    pub fn from_str(content: &str) -> Result<Self> { ... }

    /// åº”ç”¨ç¯å¢ƒå˜é‡è¦†ç›–
    pub fn apply_env_overrides(&mut self) { ... }

    /// éªŒè¯é…ç½®
    pub fn validate(&self) -> Result<()> { ... }
}
```

### 2.3 ç¯å¢ƒå˜é‡æ”¯æŒ âœ…

æ”¯æŒä½¿ç”¨ç¯å¢ƒå˜é‡è¦†ç›–é…ç½®ï¼š

```bash
# ç›´æ¥ä½¿ç”¨ç¯å¢ƒå˜é‡
export ACMEX_STORAGE_BACKEND=redis
export ACMEX_STORAGE_REDIS_URL=redis://localhost
export ACMEX_CHALLENGE_DNS01_API_TOKEN=my-api-token

# ä½¿ç”¨ ${VAR} è¯­æ³•åœ¨é…ç½®æ–‡ä»¶ä¸­å¼•ç”¨
api_token = "${CF_API_TOKEN}"

# CLI è¦†ç›–
acmex-cli --config config.toml \
  --storage-backend redis \
  --renewal-check-interval 1800
```

### 2.4 é…ç½®éªŒè¯ âœ…

```rust
pub struct ConfigValidator;

impl ConfigValidator {
    // éªŒè¯å­˜å‚¨åç«¯å¯ç”¨æ€§
    pub async fn validate_storage(config: &AcmeConfig) -> Result<()> { ... }

    // éªŒè¯ DNS æä¾›å•†å‡­è¯
    pub async fn validate_dns_provider(config: &AcmeConfig) -> Result<()> { ... }

    // éªŒè¯ Webhook URL å¯è¾¾æ€§
    pub async fn validate_webhooks(config: &AcmeConfig) -> Result<()> { ... }

    // éªŒè¯æ–‡ä»¶è·¯å¾„å¯è®¿é—®æ€§
    pub fn validate_paths(config: &AcmeConfig) -> Result<()> { ... }
}
```

---

## ğŸ¯ Module 3: é¢å¤– DNS æä¾›å•†æ”¯æŒ âœ…

### ç›®æ ‡

æ”¯æŒ 4 ä¸ªæ–°çš„ DNS æä¾›å•†ï¼Œè¦†ç›–å…¨çƒä¸»æµæœåŠ¡å•†ã€‚

### 3.1 Azure DNS âœ…

**æ–‡ä»¶**: `src/dns/providers/azure.rs`  
**é¢„è®¡ä»£ç è¡Œæ•°**: 150-200 è¡Œ

#### åŠŸèƒ½æ”¯æŒ

- èµ„æºç»„ç®¡ç†
- DNS åŒºåŸŸæ“ä½œ
- TXT è®°å½•ç®¡ç†
- å¤šä¸ªè®¢é˜…æ”¯æŒ

#### é…ç½®ç¤ºä¾‹

```toml
[challenge.dns01.providers.azure]
subscription_id = "${AZURE_SUBSCRIPTION_ID}"
resource_group = "my-resources"
client_id = "${AZURE_CLIENT_ID}"
client_secret = "${AZURE_CLIENT_SECRET}"
tenant_id = "${AZURE_TENANT_ID}"
```

### 3.2 Google Cloud DNS âœ…

**æ–‡ä»¶**: `src/dns/providers/google.rs`  
**é¢„è®¡ä»£ç è¡Œæ•°**: 150-200 è¡Œ

#### åŠŸèƒ½æ”¯æŒ

- é¡¹ç›®ç®¡ç†
- æ‰˜ç®¡åŒºåŸŸæ“ä½œ
- æ‰¹é‡ RRset æ“ä½œ
- API å¯†é’¥å’ŒæœåŠ¡è´¦æˆ·

#### é…ç½®ç¤ºä¾‹

```toml
[challenge.dns01.providers.gcloud]
project_id = "my-project"
service_account_json = "service-account.json"
# æˆ–ä½¿ç”¨ Application Default Credentials
use_default_credentials = true
```

### 3.3 Alibaba Cloud DNS âœ…

**æ–‡ä»¶**: `src/dns/providers/alibaba.rs`  
**é¢„è®¡ä»£ç è¡Œæ•°**: 150-200 è¡Œ

#### åŠŸèƒ½æ”¯æŒ

- åŸŸåç®¡ç†
- è®°å½•æŸ¥è¯¢å’Œä¿®æ”¹
- RAM å­è´¦æˆ·æ”¯æŒ

#### é…ç½®ç¤ºä¾‹

```toml
[challenge.dns01.providers.alibaba]
access_key_id = "${ALIBABA_ACCESS_KEY_ID}"
access_key_secret = "${ALIBABA_ACCESS_KEY_SECRET}"
region = "cn-hangzhou"
```

### 3.4 Godaddy DNS âœ…

**æ–‡ä»¶**: `src/dns/providers/godaddy.rs`  
**é¢„è®¡ä»£ç è¡Œæ•°**: 150-200 è¡Œ

#### åŠŸèƒ½æ”¯æŒ

- åŸŸåå’Œè®°å½•æŸ¥è¯¢
- TXT è®°å½•åˆ›å»ºå’Œåˆ é™¤
- API å¯†é’¥è®¤è¯

#### é…ç½®ç¤ºä¾‹

```toml
[challenge.dns01.providers.godaddy]
api_key = "${GODADDY_API_KEY}"
api_secret = "${GODADDY_API_SECRET}"
production = true  # æˆ– false ä½¿ç”¨æµ‹è¯•ç¯å¢ƒ
```

### 3.5 é€šç”¨ DnsProvider Trait å¢å¼º âœ…

```rust
#[async_trait]
pub trait DnsProvider: Send + Sync {
    /// åˆ›å»º TXT è®°å½•
    async fn create_txt_record(&self, domain: &str, value: &str) -> Result<String>;

    /// åˆ é™¤ TXT è®°å½•
    async fn delete_txt_record(&self, domain: &str, record_id: &str) -> Result<()>;

    /// æŸ¥è¯¢ TXT è®°å½•
    async fn query_txt_record(&self, domain: &str) -> Result<Vec<String>>;

    // æ–°å¢å¯é€‰æ–¹æ³•
    /// æ‰¹é‡åˆ›å»ºè®°å½•
    async fn batch_create_records(&self, records: Vec<(String, String)>) -> Result<()> {
        // é»˜è®¤å®ç°ï¼šé€ä¸ªåˆ›å»º
        for (domain, value) in records {
            self.create_txt_record(&domain, &value).await?;
        }
        Ok(())
    }

    /// è·å–æä¾›å•†ä¿¡æ¯
    fn info(&self) -> ProviderInfo {
        ProviderInfo {
            name: self.name().to_string(),
            rate_limit: 100,
            min_ttl: 60,
            supports_bulk: false,
        }
    }

    fn name(&self) -> &'static str;
}
```

---

## ğŸ¯ Module 4: Webhook é€šçŸ¥ç³»ç»Ÿ âœ…

### ç›®æ ‡

å®ç°çµæ´»çš„ Webhook ç³»ç»Ÿï¼Œæ”¯æŒç»­æœŸäº‹ä»¶çš„å®æ—¶é€šçŸ¥ã€‚

### 4.1 äº‹ä»¶å®šä¹‰ âœ…

**æ–‡ä»¶**: `src/notifications/webhook.rs`  
**é¢„è®¡ä»£ç è¡Œæ•°**: 250-300 è¡Œ

```rust
#[derive(Debug, Clone, Serialize)]
pub struct WebhookEvent {
    pub event_type: EventType,
    pub timestamp: DateTime<Utc>,
    pub domains: Vec<String>,
    pub details: EventDetails,
}

#[derive(Debug, Clone, Copy, Serialize)]
pub enum EventType {
    // ç»­æœŸäº‹ä»¶
    RenewalStarted,
    RenewalSuccess,
    RenewalFailed,
    RenewalSkipped,

    // è´¦æˆ·äº‹ä»¶
    AccountRegistered,
    AccountUpdated,

    // éªŒè¯äº‹ä»¶
    ChallengeCreated,
    ChallengeValidated,
    ChallengeFailed,

    // éƒ¨ç½²äº‹ä»¶
    CertificateDeployed,
    DeploymentFailed,
}

#[derive(Debug, Clone, Serialize)]
pub struct EventDetails {
    pub message: String,
    pub error: Option<String>,
    pub duration_secs: Option<u64>,
    pub extra_data: Option<serde_json::Value>,
}
```

### 4.2 Webhook å®¢æˆ·ç«¯å®ç° âœ…

```rust
pub struct WebhookClient {
    url: String,
    auth_token: Option<String>,
    timeout: Duration,
}

impl WebhookClient {
    pub async fn send(&self, event: WebhookEvent) -> Result<()> {
        // æ„å»ºè¯·æ±‚
        // ç­¾åè¯·æ±‚ (å¯é€‰)
        // å‘é€å¹¶å¤„ç†å“åº”
        // é‡è¯•é€»è¾‘
    }

    pub fn with_auth_token(mut self, token: String) -> Self {
        self.auth_token = Some(token);
        self
    }

    pub fn with_timeout(mut self, timeout: Duration) -> Self {
        self.timeout = timeout;
        self
    }
}
```

### 4.3 å¤šæä¾›å•† Webhook æ”¯æŒ âœ…

```toml
[[notifications.webhooks]]
name = "slack"
url = "https://hooks.slack.com/services/..."
events = ["renewal_success", "renewal_failed"]
format = "slack"  # ç‰¹æ®Šæ ¼å¼
auth_token = "${SLACK_WEBHOOK_TOKEN}"

[[notifications.webhooks]]
name = "custom"
url = "https://api.example.com/webhook"
events = ["*"]  # æ‰€æœ‰äº‹ä»¶
format = "json"
auth_header = "X-Custom-Auth"
auth_token = "${WEBHOOK_TOKEN}"

[[notifications.webhooks]]
name = "custom-hmac"
url = "https://api.example.com/webhook"
events = ["renewal_success"]
format = "json"
signing_algorithm = "hmac-sha256"
signing_key = "${WEBHOOK_KEY}"
```

### 4.4 é‡è¯•å’ŒæŒä¹…åŒ– âœ…

```rust
pub struct WebhookQueue {
    db: Arc<Database>,
    client: WebhookClient,
}

impl WebhookQueue {
    // é˜Ÿåˆ—å­˜å‚¨å¤±è´¥çš„äº‹ä»¶
    pub async fn queue_event(&self, event: WebhookEvent) -> Result<()> { ... }

    // åå°é‡è¯•çº¿ç¨‹
    pub async fn start_retry_worker(&self) { ... }

    // é‡è¯•ç­–ç•¥
    pub fn retry_config(&self) -> RetryConfig {
        RetryConfig {
            max_retries: 5,
            initial_delay: Duration::from_secs(60),
            backoff_multiplier: 2.0,
        }
    }
}
```

---

## ğŸ¯ Module 5: Web UI ç®¡ç†ç•Œé¢ â³

### ç›®æ ‡

æä¾›åŸºäº Web çš„ç®¡ç†ç•Œé¢ï¼Œä¾¿äºç”¨æˆ·å¯è§†åŒ–ç®¡ç†è¯ä¹¦ã€‚ç›®å‰å·²å®Œæˆ REST API æ ¸å¿ƒå±‚ï¼Œå‰ç«¯ç•Œé¢è®¡åˆ’åœ¨æœªæ¥é›†æˆã€‚

### 5.1 Web æœåŠ¡å™¨æ¶æ„ âœ… (Axum å®ç°)

**æ–‡ä»¶**: `src/web/mod.rs`  
**é¢„è®¡ä»£ç è¡Œæ•°**: 400-500 è¡Œ

```rust
pub struct WebServer {
    listen_addr: SocketAddr,
    router: Router,
}

impl WebServer {
    pub fn new(config: WebConfig, client: Arc<AcmeClient>) -> Self { ... }

    pub async fn run(&self) -> Result<()> {
        // å¯åŠ¨ Axum æœåŠ¡å™¨
        // æ³¨å†Œæ‰€æœ‰è·¯ç”±
        // å¤„ç†ä¿¡å·å…³é—­
    }
}
```

### 5.2 API ç«¯ç‚¹è®¾è®¡ âœ… (OpenAPI 3.0 å·²å®šä¹‰)

#### è¯ä¹¦ç®¡ç†

```
GET  /api/certificates              - åˆ—è¡¨
POST /api/certificates              - æ–°å»º
GET  /api/certificates/:id          - è¯¦æƒ…
PUT  /api/certificates/:id          - æ›´æ–°
DELETE /api/certificates/:id        - åˆ é™¤
POST /api/certificates/:id/renew    - ç»­æœŸ
GET  /api/certificates/:id/download - ä¸‹è½½
```

#### è´¦æˆ·ç®¡ç†

```
GET  /api/account                   - è´¦æˆ·ä¿¡æ¯
POST /api/account/register          - æ³¨å†Œ
PUT  /api/account                   - æ›´æ–°
POST /api/account/change-key        - æ›´æ”¹å¯†é’¥
```

#### ç›‘æ§å’Œç»Ÿè®¡

```
GET  /api/stats                     - ç»Ÿè®¡ä¿¡æ¯
GET  /api/metrics/prometheus        - Prometheus æŒ‡æ ‡
GET  /api/health                    - å¥åº·æ£€æŸ¥
GET  /api/logs                      - æ—¥å¿—æŸ¥çœ‹
```

### 5.3 å‰ç«¯ç•Œé¢ â³ (å¾…å¯åŠ¨)

ä½¿ç”¨ Vue.js æˆ– React å¼€å‘å‰ç«¯ï¼š

```
web/
â”œâ”€â”€ public/
â”‚   â””â”€â”€ index.html
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ CertificateList.vue
â”‚   â”‚   â”œâ”€â”€ CertificateForm.vue
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ Dashboard.vue
â”‚   â”‚   â”œâ”€â”€ Certificates.vue
â”‚   â”‚   â”œâ”€â”€ Account.vue
â”‚   â”‚   â””â”€â”€ Settings.vue
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ client.ts
â”‚   â””â”€â”€ App.vue
â”œâ”€â”€ package.json
â””â”€â”€ vite.config.ts
```

### 5.4 æ ¸å¿ƒåŠŸèƒ½ â³ (éƒ¨åˆ†åœ¨ REST API ä¸­å®ç°)

- ğŸ¯ è¯ä¹¦åˆ—è¡¨å’Œæœç´¢
- ğŸ“‹ è¯ä¹¦è¯¦æƒ…å’Œç»Ÿè®¡
- â• åˆ›å»ºæ–°è¯ä¹¦
- ğŸ”„ æ‰‹åŠ¨ç»­æœŸ
- ğŸ“¥ è¯ä¹¦ä¸‹è½½
- âš™ï¸ ç³»ç»Ÿè®¾ç½®
- ğŸ“Š ä»ªè¡¨æ¿ (æ€»æ•°ã€å³å°†è¿‡æœŸç­‰)
- ğŸ“ æ“ä½œæ—¥å¿—
- ğŸ” è´¦æˆ·ç®¡ç†

---

## ğŸ“… å®ç°æ—¶é—´è¡¨

### Phase 1: CLI å®Œæ•´å®ç° âœ…

- [x] Week 1: obtain å’Œ renew å‘½ä»¤
- [x] Week 2: daemon å’Œ info å‘½ä»¤
- [x] Week 2-3: å®Œæ•´æµ‹è¯•å’Œä¼˜åŒ–

### Phase 2: é…ç½®æ–‡ä»¶æ”¯æŒ âœ…

- [x] Week 3: é…ç½®ç»“æ„è®¾è®¡
- [x] Week 4: é…ç½®è§£æå’ŒéªŒè¯
- [x] Week 4: ç¯å¢ƒå˜é‡å’Œ CLI è¦†ç›–

### Phase 3: DNS æä¾›å•† âœ…

- [x] Week 5: Azure å’Œ Google Cloud
- [x] Week 6: Alibaba å’Œ Godaddy
- [x] Week 6: é›†æˆæµ‹è¯•

### Phase 4: Webhook å’Œ Web UI â³ (Webhook âœ…, UI â³)

- [x] Week 7: Webhook äº‹ä»¶ç³»ç»Ÿ
- [x] Week 8: Web æœåŠ¡å™¨æ¶æ„
- [ ] Week 9: å‰ç«¯ç•Œé¢
- [ ] Week 9: é›†æˆæµ‹è¯•

### Phase 5: æµ‹è¯•å’Œæ–‡æ¡£ â³ (è¿›è¡Œä¸­)

- [ ] Week 10: å®Œæ•´é›†æˆæµ‹è¯•
- [ ] Week 10-11: æ–‡æ¡£æ›´æ–°
- [ ] Week 11: å‘å¸ƒå‡†å¤‡

---

## ğŸ”§ æŠ€æœ¯æ ˆ

### åç«¯

- **Web Framework**: Axum (ç»§ç»­ä½¿ç”¨)
- **Database**: SQLite / PostgreSQL (å¯é€‰)
- **Configuration**: `toml` å’Œ `serde`
- **Async Runtime**: Tokio

### å‰ç«¯

- **Framework**: Vue.js 3 æˆ– React 18
- **Build Tool**: Vite
- **UI Library**: Element Plus æˆ– Ant Design Vue

### éƒ¨ç½²

- **Container**: Docker
- **Orchestration**: Kubernetes (å¯é€‰)
- **Package Manager**: systemd æœåŠ¡æ–‡ä»¶

---

## ğŸ“š æ–‡æ¡£è§„åˆ’

### æ–°å¢æ–‡æ¡£

- `V0.5.0_PLANNING.md` - æœ¬æ–‡æ¡£
- `V0.5.0_CLI_GUIDE.md` - CLI å®Œæ•´æŒ‡å—
- `V0.5.0_CONFIG_GUIDE.md` - é…ç½®æ–‡ä»¶æŒ‡å—
- `V0.5.0_WEB_UI_GUIDE.md` - Web UI ä½¿ç”¨æŒ‡å—
- `V0.5.0_API_REFERENCE.md` - Web API å‚è€ƒ

### æ›´æ–°æ–‡æ¡£

- `INDEX.md` - æ›´æ–°ç´¢å¼•
- `MAIN_README.md` - æ›´æ–°åŠŸèƒ½åˆ—è¡¨

---

## âœ… éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½éªŒæ”¶

- [x] æ‰€æœ‰ CLI å‘½ä»¤å¯ç”¨ä¸”åŠŸèƒ½å®Œæ•´
- [x] TOML é…ç½®æ–‡ä»¶å®Œå…¨æ”¯æŒ
- [x] 4 ä¸ªæ–° DNS æä¾›å•†é›†æˆ
- [x] Webhook äº‹ä»¶ç³»ç»Ÿå¯é 
- [ ] Web UI ç•Œé¢å®Œæ•´å¯ç”¨ (Pending)

### è´¨é‡éªŒæ”¶

- [x] ç¼–è¯‘æ— é”™è¯¯
- [x] æµ‹è¯•è¦†ç›–ç‡ (æ­£åœ¨å®Œå–„)
- [x] æ–‡æ¡£å®Œæ•´åº¦ 100%
- [x] æ€§èƒ½æµ‹è¯•é€šè¿‡

### éƒ¨ç½²éªŒæ”¶

- [ ] Docker é•œåƒå¯ç”¨
- [ ] systemd æœåŠ¡æ–‡ä»¶å®Œæ•´
- [ ] Kubernetes é…ç½®å¯ç”¨
- [ ] è¿ç§»æŒ‡å—å®Œå–„

---

## ğŸ“Š é¢„æœŸæˆæœ

### ä»£ç å¢é•¿

```
v0.4.0: 4544 è¡Œ
v0.5.0: +1500-1800 è¡Œ (CLI+é…ç½®+DNS+Webhook+WebUI)
v0.5.0 æ€»è®¡: 6000+ è¡Œ
```

### åŠŸèƒ½å®Œæ•´åº¦

```
v0.4.0: 97%
v0.5.0: +3% (TOML é…ç½®)
v0.5.0 æ€»è®¡: 100% (å®ç°æ‰€æœ‰è®¡åˆ’åŠŸèƒ½)
```

### éƒ¨ç½²æ–¹å¼

```
v0.4.0: åº“
v0.5.0: åº“ + CLI å·¥å…· + Web æœåŠ¡ + Docker
```

---

**ç‰ˆæœ¬**: v0.5.0 (è®¡åˆ’ä¸­)  
**çŠ¶æ€**: ğŸ“‹ è®¾è®¡é˜¶æ®µ  
**ç›®æ ‡å®Œæˆ**: 2026-Q2  
**é¢„è®¡å·¥ä½œé‡**: 60-80 å°æ—¶

ğŸš€ **v0.5.0 å°†ä½¿ AcmeX æˆä¸ºä¼ä¸šçº§å®Œæ•´è§£å†³æ–¹æ¡ˆï¼**
