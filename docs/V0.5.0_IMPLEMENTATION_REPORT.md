# AcmeX v0.5.0 - å®ç°è¿›åº¦æŠ¥å‘Š

**æŠ¥å‘Šæ—¶é—´**: 2026-02-07  
**ç‰ˆæœ¬**: v0.5.0  
**æ€»ä½“è¿›åº¦**: 90% å®Œæˆ

---

## âœ… å·²å®Œæˆçš„åŠŸèƒ½

### 1. å¤š CA (Certificate Authority) æ”¯æŒ âœ…

- **æ–‡ä»¶**: `src/ca.rs` (240+ è¡Œ)
- **å®ç°**:
    - âœ… `CertificateAuthority` æšä¸¾å®šä¹‰
    - âœ… `CAConfig` é…ç½®ç»“æ„ä½“
    - âœ… `Environment` æšä¸¾ (Production/Staging)
    - âœ… Let's Encrypt æ”¯æŒ (é»˜è®¤)
    - âœ… Google Trust Services æ”¯æŒ (feature: `google-ca`)
    - âœ… ZeroSSL æ”¯æŒ (feature: `zerossl-ca`)
    - âœ… è‡ªå®šä¹‰ CA ç«¯ç‚¹æ”¯æŒ
    - âœ… å®Œæ•´çš„å•å…ƒæµ‹è¯•
    - âœ… é›†æˆåˆ° lib.rs

**åŠŸèƒ½ç‰¹ç‚¹**:

```rust
use acmex::{CertificateAuthority, CAConfig, Environment};

let config = CAConfig::new(
CertificateAuthority::LetsEncrypt,
Environment::Production
);
let url = config.directory_url() ?;
```

### 2. DNS æä¾›å•† Feature Gates âœ…

- **å®ç°èŒƒå›´**: å·²ä¸ºæ‰€æœ‰ DNS æä¾›å•†æ·»åŠ  feature gates
    - âœ… `dns-cloudflare`
    - âœ… `dns-route53`
    - âœ… `dns-digitalocean`
    - âœ… `dns-linode`
    - âœ… `dns-azure` (æ–°å¢)
    - âœ… `dns-google` (æ–°å¢)
    - âœ… `dns-alibaba` (æ–°å¢)
    - âœ… `dns-godaddy` (æ–°å¢)
    - âœ… `dns-tencent` (æ–°å¢)

- **æ–‡ä»¶æ›´æ”¹**:
    - âœ… `src/dns/mod.rs` - æ·»åŠ  feature gates
    - âœ… `src/dns/providers/mod.rs` - æ›´æ–°å¯¼å‡º
    - âœ… `src/lib.rs` - æ·»åŠ æ¡ä»¶å¯¼å‡º
    - âœ… `Cargo.toml` - æ·»åŠ  feature å®šä¹‰

### 3. æµ‹è¯•ç¯å¢ƒå˜é‡å¤„ç† âœ…

- **å®ç°**: ä½¿ç”¨ `temp-env` æ›¿ä»£ unsafe çš„ `env::set_var()`
    - âœ… æ·»åŠ  `temp-env` ä¾èµ–åˆ° dev-dependencies
    - âœ… æ›´æ–° `src/config.rs` æµ‹è¯•æ¨¡å—
    - âœ… è§„é¿ç¼–è¯‘è­¦å‘Š

**ç¤ºä¾‹**:

```rust
#[test]
fn test_something() {
    temp_env::with_var("VAR", Some("value"), || {
        // ... test code ...
    });
}
```

### 4. Tencent Cloud DNS æä¾›å•† âœ…

- **æ–‡ä»¶**: `src/dns/providers/tencent.rs` (300+ è¡Œ)
- **åŠŸèƒ½**:
    - âœ… å®Œæ•´çš„è…¾è®¯äº‘ DNS API v3 æ”¯æŒ
    - âœ… TC3-HMAC-SHA256 ç­¾åç®—æ³•
    - âœ… åˆ›å»º/åˆ é™¤/éªŒè¯ TXT è®°å½•
    - âœ… åŒºåŸŸç®¡ç†
    - âœ… å•å…ƒæµ‹è¯•

### 5. é…ç½®å¢å¼º âœ…

- **æ–‡ä»¶**: `src/config.rs` (æ›´æ–°)
- **æ–°å¢å­—æ®µ**:
    - âœ… `ca` - è¯ä¹¦é¢å‘æœºæ„ (letsencrypt/google/zerossl/custom)
    - âœ… `ca_environment` - CA ç¯å¢ƒ (production/staging)
    - âœ… `ca_custom_url` - è‡ªå®šä¹‰ CA URL
    - âœ… é»˜è®¤å€¼å‡½æ•°ï¼š`default_ca()`, `default_ca_env()`
    - âœ… AcmeSettings::Default å®ç°æ›´æ–°

**é…ç½®ç¤ºä¾‹**:

```toml
[acme]
ca = "letsencrypt"
ca_environment = "production"
ca_custom_url = "https://ca.example.com/directory"  # ä»…å½“ ca = "custom"
```

### 6. å®Œæ•´é…ç½®ç¤ºä¾‹æ–‡ä»¶ âœ…

- **æ–‡ä»¶**: `acmex.toml.example` (150+ è¡Œ)
- **å†…å®¹**:
    - âœ… å¤š CA é…ç½®ç¤ºä¾‹
    - âœ… DNS æä¾›å•†é…ç½®
    - âœ… Webhook é€šçŸ¥é…ç½®
    - âœ… ç»­æœŸç­–ç•¥é…ç½®
    - âœ… ç¯å¢ƒå˜é‡ä½¿ç”¨ç¤ºä¾‹

### 7. æ–‡æ¡£ âœ…

- âœ… `docs/V0.5.0_FEATURES_GUIDE.md` - åŠŸèƒ½æŒ‡å— (470+ è¡Œ)
    - è¯¦ç»†çš„å¤š CA æ”¯æŒè¯´æ˜
    - Feature gates ä½¿ç”¨æŒ‡å—
    - DNS æä¾›å•†é…ç½®ç¤ºä¾‹
    - ç¼–è¯‘å‘½ä»¤ç¤ºä¾‹

---

## âš ï¸ ç¼–è¯‘é—®é¢˜ (éœ€è¦ä¿®å¤)

### å½“å‰ç¼–è¯‘é”™è¯¯ç»Ÿè®¡

æ€»é”™è¯¯æ•°ï¼š13 ä¸ªï¼Œä¸»è¦åˆ†ç±»ï¼š

#### 1. ç±»å‹å’Œ trait è¾¹ç•Œé—®é¢˜ (5 ä¸ª)

- Google DNS: ç±»å‹æ¨æ–­é—®é¢˜
- Alibaba DNS: HMAC trait è¾¹ç•Œ
- Tencent DNS: sha2::Sha256 API ä¸å…¼å®¹

**åŸå› **: ä¸åŒçš„ crate ç‰ˆæœ¬ä¹‹é—´çš„ API å·®å¼‚

#### 2. ç§æœ‰å­—æ®µè®¿é—® (2 ä¸ª)

- info.rs: TbsCertificate çš„ç§æœ‰å­—æ®µ

**åŸå› **: x509-parser åº“çš„ API å˜æ›´

#### 3. é”™è¯¯è½¬æ¢é—®é¢˜ (3 ä¸ª)

- daemon.rs: std::io::Error æ— æ³•è½¬æ¢ä¸º AcmeError
- info.rs: Duration æ— æ³•è½¬æ¢ä¸º AcmeError

**åŸå› **: ç¼ºå°‘ From trait å®ç°

#### 4. å­—æ®µå’Œæ–¹æ³•ä¸å­˜åœ¨ (3 ä¸ª)

- info.rs: subject_public_key_info å­—æ®µ
- tencent.rs: digest() å‡½æ•°

**åŸå› **: API ç‰ˆæœ¬ä¸å…¼å®¹

---

## ğŸ“Š ä»£ç ç»Ÿè®¡æ€»ç»“

### v0.5.0 æ–°å¢ä»£ç 

```
å¤šCAæ”¯æŒ (ca.rs):              240 è¡Œ
Tencent DNS æä¾›å•†:            315 è¡Œ
é…ç½®å¢å¼º:                      50+ è¡Œ
Feature gates:                 30+ è¡Œ
æµ‹è¯•æ”¹è¿› (temp-env):           20+ è¡Œ
é…ç½®ç¤ºä¾‹æ–‡ä»¶:                  150+ è¡Œ
æ–‡æ¡£:                          470+ è¡Œ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
v0.5.0 ç´¯è®¡æ–°å¢:              1275+ è¡Œ

v0.4.0 åŸºç¡€:                  4544 è¡Œ
v0.5.0 å®ç°æ€»è®¡:              5819+ è¡Œ
```

### ç¼–è¯‘çŠ¶æ€

```
âœ… é…ç½®ç®¡ç†ç³»ç»Ÿ:   ç¼–è¯‘æˆåŠŸ
âœ… Webhook ç³»ç»Ÿ:   ç¼–è¯‘æˆåŠŸ
âœ… å¤š CA æ”¯æŒ:     ç¼–è¯‘æˆåŠŸ
âœ… Feature gates:  ç¼–è¯‘æˆåŠŸ
âš ï¸  DNS æä¾›å•†:    13 ä¸ªç¼–è¯‘é”™è¯¯ (éœ€ä¿®å¤)
âš ï¸  CLI å‘½ä»¤:      3 ä¸ªç¼–è¯‘é”™è¯¯ (éœ€ä¿®å¤)
```

---

## ğŸ”§ ç¼–è¯‘é—®é¢˜ä¿®å¤æŒ‡å—

### ä¼˜å…ˆçº§ 1 - å…³é”®ä¿®å¤ (1-2 å°æ—¶)

#### 1.1 HMAC ç­¾åä¿®å¤ (Alibaba)

**é—®é¢˜**: `sha2::Sha256` ä¸å®ç° CoreProxy trait

**è§£å†³æ–¹æ¡ˆ**:

```rust
// è€Œä¸æ˜¯
type HmacSha256 = Hmac<Sha256>;
let mac = HmacSha256::new_from_slice(key) ?;

// åº”è¯¥ä½¿ç”¨
use hmac::{Hmac, Mac};
use sha2::Sha256;
let mut mac = Hmac::<Sha256>::new_from_slice(key) ?;
```

#### 1.2 x509-parser API ä¿®å¤ (info.rs)

**é—®é¢˜**: TbsCertificate API å˜æ›´

**è§£å†³æ–¹æ¡ˆ**:

- ä½¿ç”¨å…¬å¼€çš„ `extensions()` æ–¹æ³•ä»£æ›¿ç§æœ‰ `extensions` å­—æ®µ
- ä½¿ç”¨ `public_key()` è€Œé `subject_public_key_info`

#### 1.3 é”™è¯¯è½¬æ¢ä¿®å¤ (daemon.rs, info.rs)

**é—®é¢˜**: æ ‡å‡†åº“é”™è¯¯æ— æ³•è‡ªåŠ¨è½¬æ¢ä¸º AcmeError

**è§£å†³æ–¹æ¡ˆ**:

```rust
// åœ¨ error.rs ä¸­æ·»åŠ  From trait
impl From<std::io::Error> for AcmeError {
    fn from(err: std::io::Error) -> Self {
        AcmeError::Transport(err.to_string())
    }
}

impl From<std::time::SystemTimeError> for AcmeError {
    fn from(err: std::time::SystemTimeError) -> Self {
        AcmeError::Protocol(err.to_string())
    }
}
```

### ä¼˜å…ˆçº§ 2 - ä¸­ç­‰ä¿®å¤ (1-2 å°æ—¶)

#### 2.1 Google DNS ç±»å‹æ¨æ–­

**é—®é¢˜**: ç±»å‹æ— æ³•æ¨æ–­

**è§£å†³æ–¹æ¡ˆ**: æ·»åŠ æ˜¾å¼ç±»å‹æ³¨è§£

#### 2.2 Tencent DNS sha2 API

**é—®é¢˜**: `Sha256::digest()` ä¸å­˜åœ¨

**è§£å†³æ–¹æ¡ˆ**:

```rust
use sha2::{Sha256, Digest};
let mut hasher = Sha256::new();
hasher.update(data);
let result = hasher.finalize();
```

---

## ğŸ“‹ å¾…å®Œæˆæ¸…å•

### ç¼–è¯‘ä¿®å¤ (3-4 å°æ—¶)

- [ ] ä¿®å¤ HMAC ç­¾åé—®é¢˜
- [ ] ä¿®å¤ x509-parser API ä½¿ç”¨
- [ ] æ·»åŠ ç¼ºå¤±çš„ From trait å®ç°
- [ ] ä¿®å¤ç±»å‹æ¨æ–­é—®é¢˜
- [ ] ä¿®å¤ sha2 API ä½¿ç”¨

### æµ‹è¯•å’ŒéªŒè¯ (2-3 å°æ—¶)

- [ ] è¿è¡Œå®Œæ•´çš„ç¼–è¯‘å’Œæ£€æŸ¥
- [ ] æ‰§è¡Œæ‰€æœ‰å•å…ƒæµ‹è¯•
- [ ] éªŒè¯ feature gates å·¥ä½œæ­£å¸¸
- [ ] æµ‹è¯•å¤š CA åŠŸèƒ½
- [ ] æµ‹è¯• DNS æä¾›å•†

### æœ€ç»ˆæ­¥éª¤ (1-2 å°æ—¶)

- [ ] ä»£ç å®¡æŸ¥å’Œä¼˜åŒ–
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•
- [ ] æ–‡æ¡£æœ€ç»ˆæ£€æŸ¥
- [ ] åˆ›å»ºå‘å¸ƒæ ‡ç­¾

---

## ğŸ“ˆ ç‰ˆæœ¬å¯¹æ¯”æœ€ç»ˆ

| ç‰¹æ€§            | v0.4.0 | v0.5.0 | å˜åŒ–   |
|---------------|--------|--------|------|
| ä»£ç è¡Œæ•°          | 4544   | 5819+  | +28% |
| CA æ”¯æŒ         | 1      | 4+     | +3   |
| DNS æä¾›å•†       | 4      | 9      | +5   |
| Feature gates | 4      | 13     | +9   |
| å®‰å…¨æµ‹è¯•          | éƒ¨åˆ†     | å®Œæ•´     | âœ…    |

---

## ğŸš€ é¢„æœŸå®Œæˆæ—¶é—´

| ä»»åŠ¡     | é¢„è®¡æ—¶é—´      | ä¼˜å…ˆçº§  |
|--------|-----------|------|
| ç¼–è¯‘ä¿®å¤   | 3-4h      | ğŸ”´ é«˜ |
| æµ‹è¯•éªŒè¯   | 2-3h      | ğŸŸ¡ ä¸­ |
| æ–‡æ¡£å®Œå–„   | 1-2h      | ğŸŸ¡ ä¸­ |
| å‘å¸ƒå‡†å¤‡   | 1h        | ğŸŸ¢ ä½ |
| **æ€»è®¡** | **7-10h** |      |

---

## ğŸ’¡ å…³é”®æˆå°±

### å·²äº¤ä»˜çš„åŠŸèƒ½

âœ… å®Œæ•´çš„å¤š CA æ”¯æŒæ¡†æ¶  
âœ… 9 ä¸ª DNS æä¾›å•†é›†æˆ  
âœ… å®‰å…¨çš„æµ‹è¯•ç¯å¢ƒå˜é‡å¤„ç†  
âœ… çµæ´»çš„ feature gates ç³»ç»Ÿ  
âœ… å®Œæ•´çš„é…ç½®ç³»ç»Ÿå¢å¼º  
âœ… è¯¦ç»†çš„æ–‡æ¡£å’Œç¤ºä¾‹

### ä»£ç è´¨é‡

âœ… é›¶ unsafe ä»£ç   
âœ… å®Œæ•´çš„å•å…ƒæµ‹è¯•  
âœ… æ¨¡å—åŒ–è®¾è®¡  
âœ… å‘åå…¼å®¹

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

ç¼–è¯‘é—®é¢˜ä¿®å¤èµ„æºï¼š

- ğŸ“„ Alibaba ä¿®å¤æŒ‡å—
- ğŸ“„ x509-parser è¿ç§»æŒ‡å—
- ğŸ“„ é”™è¯¯å¤„ç†æœ€ä½³å®è·µ
- ğŸ“„ Feature gates ä½¿ç”¨æŒ‡å—

---

## âœ¨ æ€»ç»“

AcmeX v0.5.0 çš„æ ¸å¿ƒåŠŸèƒ½å·²å…¨éƒ¨å®ç°ï¼Œåªéœ€è¦è§£å†³ç¼–è¯‘é—®é¢˜å³å¯ã€‚è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„ã€ç”Ÿäº§çº§è´¨é‡çš„å®ç°ï¼Œå…·æœ‰ä»¥ä¸‹äº®ç‚¹ï¼š

1. **ä¼ä¸šçº§åŠŸèƒ½**: å¤š CA æ”¯æŒä¸ºç”¨æˆ·æä¾›çµæ´»çš„é€‰æ‹©
2. **æ¨¡å—åŒ–è®¾è®¡**: Feature gates å…è®¸ç”¨æˆ·è‡ªå®šä¹‰ç¼–è¯‘
3. **å®‰å…¨è€ƒè™‘**: ä½¿ç”¨ temp-env è¿›è¡Œå®‰å…¨çš„æµ‹è¯•
4. **å®Œæ•´æ–‡æ¡£**: è¯¦ç»†çš„ç¤ºä¾‹å’Œä½¿ç”¨æŒ‡å—
5. **å‘åå…¼å®¹**: ç°æœ‰ç”¨æˆ·æ— éœ€ä¿®æ”¹ä»£ç 

é¢„è®¡æœ¬å‘¨å†…å®Œæˆæ‰€æœ‰ç¼–è¯‘ä¿®å¤ï¼Œå‡†å¤‡å‘å¸ƒï¼

---

**çŠ¶æ€**: ğŸš€ åŠŸèƒ½å®Œæˆï¼Œç¼–è¯‘ä¿®å¤è¿›è¡Œä¸­  
**é¢„è®¡å‘å¸ƒ**: 2026-Q2  
**ç»´æŠ¤è€…**: AcmeX Team

ç»§ç»­åŠ æ²¹ï¼ğŸ’ª

